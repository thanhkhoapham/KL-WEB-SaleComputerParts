<div class="nav-md" th:fragment="table-order">
	<div class="container body">
		<div class="main_container">
			<div class="right_col" role="main" style="min-height: 792px;">
				<div class="">
					<div class="row">
						<div class="col-md-12 col-sm-12 ">
							<div class="x_panel">
								<div class="x_title">
									<h2>
										Danh sách đơn hàng <small></small>
									</h2>
									<div class="clearfix"></div>
								</div>
								
								
								<div class="x_content">
									<div class="row">
										<div class="col-sm-12">
											<div class="card-box table-responsive">
												<div id="datatable_wrapper"
													class="dataTables_wrapper container-fluid dt-bootstrap no-footer">

													<div class="row">
														<div class="col-sm-12">
															<table id="datatable"
																class="table table-striped table-bordered dataTable no-footer"
																style="width: 100%;" role="grid"
																aria-describedby="datatable_info">
																<thead>
																	<tr role="row">
																		<th class="sorting_asc" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			aria-sort="ascending"
																			style="width: 5%;">STT</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 5%;">Mã đơn hàng</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 15%;">Ngày đặt</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 15%;">Ngày giao dự kiến</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 12%;">Tổng tiền</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 15%;">PT Thanh toán</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 12%;">Trạng thái</th>
																		<th class="sorting" tabindex="0"
																			aria-controls="datatable" rowspan="1" colspan="1"
																			style="width: 25%;">Tác vụ</th>
																	</tr>
																</thead>
																<tbody>
																	<tr th:each="order : ${orders}">
																		<td class="sorting_1" th:text="${orderStat.index+1}"></td>
																		<td th:text="${order.id}"></td>
																		<td th:text="${#dates.format(order.ngayDat, 'dd-MMM-yyyy')}"></td>
																		<td th:text="${#dates.format(order.ngayGiao, 'dd-MMM-yyyy')}"></td>
																		<td th:text="${#numbers.formatDecimal(order.tongTien, 0, 'COMMA', 0, 'POINT') +' đ'}"></td>
																		<td th:text="${order.phuongThuc == 'TTtructiep' ? 'Thanh toán trực tiếp' : 'PayPal'}"></td>
																		<td  th:text="${order.trangThai.displayValue}"></td>
																		
																		<td>
																			<a th:href="@{/admin/order(id=${order.id})}" class="btn btn-info btn-xs"><i class="fa fa-edit"></i> Xem </a> 
																			<!-- <a th:if="${!#strings.equals(order.trangThai, 'da_huy') && !#strings.equals(order.trangThai, 'da_giao_hang')}"
																				th:href="@{/admin/order/changeStatus(id=${order.id}, stt = 'da_huy')}" class="btn btn-danger btn-xs">
																				<i class="fa fa-trash"></i> Hủy </a> -->
																				
																			<a 	th:if="${!#strings.equals(order.trangThai, 'da_huy') && !#strings.equals(order.trangThai, 'da_giao_hang')}"
																				th:data-id ="${order.id}"
																				onclick="showModal(this.getAttribute('data-id'))"
																				class="btn btn-danger btn-xs" style="color: white;">
																				<i class="fa fa-trash"></i> Hủy </a>
																		</td>
																	</tr>
																</tbody>
															</table>
														</div>
														
														<script>
															function showModal(id){
																$('#yesOption').attr('href', '/admin/order/changeStatus?id='+id+'&stt=da_huy');
																$('#confirmationId').modal('show')
															}
														</script>
														
														<!--Modal-->
														<div class="modal fade" id="confirmationId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
															<div class="modal-dialog" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																		<h5 class="modal-title">Thông báo</h5>
																			<a type="button" class="close" data-dismiss="modal" aria-label="Close">
																				<span aria-hidden="true">&times;</span>
																			</a>
																	</div>
																	<div class="modal-body">
																		Hủy đơn hàng này ?
																	</div>
																	<div class="modal-footer">
																		<a id="yesOption" type="button" class="btn btn-danger">Có</a>
																		<a type="button" data-dismiss="modal" class="btn btn-primary" style="color: white">Không</a>
																	</div>
																</div>
															</div>
														</div>
														
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>